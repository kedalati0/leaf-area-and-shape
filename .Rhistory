<<<<<<< HEAD
http://bioconductor.org/biocLite.R
"http://bioconductor.org/biocLite.R"
"phyloseq"
"http://bioconductor.org/biocLite.R" "phyloseq"
"phyloseq"
install.packages(""http://bioconductor.org/biocLite.R"")
install.packages("phyloseq")
install.packages("githubinstall")
install.packages("githubinstall")
install.packages("devtools")
library("devtools")
install_github("phyloseq/joey711")
library("devtools")
install_github("phyloseq/joey711")
install_phyloseq(branch = "github")
if(!requireNamespace("BiocManager")){
install.packages("BiocManager")
}
BiocManager::install("phyloseq")
install.packages("BiocManager")
BiocManager::install("Phyloseq")
yes
a
y
BiocManager::install('phyloseq')
BiocManager::install(microbiomeseq)
BiocManager::install("microbiomeseq")
githubinstall::gh_install_packages("microbiomeSeq")
"2"
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("AnnotationDbi", "DESeq2", "GO.db", "impute", "phyloseq", "preprocessCore"))
"restart"
"restart"
defaults write org.R-project.R force.LANG en_US.UTF-8.
(!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("AnnotationDbi", "DESeq2", "GO.db", "impute", "phyloseq", "preprocessCore"))
install.packages("BiocManager")
BiocManager::install("microbiomeSeq")
http://www.bioconductor.org/biocLite.R
source("http://www.bioconductor.org/biocLite.R")
biocLite(c("fastcluster", "df2json", "rjson", "gplots", "devtools", "ggplot2","MASS","minet","mixOmics", "qvalue","reshape2","RPA","svDialogs","WGCNA"))
BiocManager::install("biocLite")
githubinstall::gh_install_packages("biocLite")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("biocLite")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(microbiomeSeq)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("microbiomeSeq")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("microbiome")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("biocLite")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("microbiomeSeq")
library(microbiomeSeq)
library(devtools)
install_github("umerijaz/microbiomeSeq")
remove.packages("vegan", lib="~/R/win-library/3.6")
library(devtools)
install_github("umerijaz/microbiomeSeq")
library(microbiomeSeq)
Skip to content
Why GitHub?
Enterprise
Explore
Marketplace
Pricing
Search
Sign in
Sign up
Code  Issues 18  Pull requests 1  Projects 0  Wiki  Security  Pulse
Join GitHub today
GitHub is home to over 40 million developers working together to host and review code, manage projects, and build software together.
microbiomeSeq/R/microbiomeSeq_helper_fxns.R
@AlfredUg AlfredUg ordination updates
5548f9e on Dec 6, 2017
23 lines (20 sloc)  725 Bytes
identify.num.variables <- function(physeq){
meta_table <- sample_data(physeq)
num.variables <- meta_table[,sapply(meta_table,is.numeric)]
names.num.variables <- names(num.variables)
return(names.num.variables)
}
get.num.variables <- function(physeq){
meta_table <- sample_data(physeq)
num.variables <- meta_table[,identify.num.variables(physeq)]
not.num.variables <- meta_table[,!colnames(meta_table)%in%colnames(num.variables)]
out <- list(num.variables=num.variables, notnum.variables=not.num.variables)
return(out)
}
select.vars <- function(df1, df2, select.variables=NULL){
if(!is.null(select.variables)){
df1 <- df1[,colnames(df1)%in%select.variables]
}
out<-cbind(df1,df2)
return(out)
}
Â© 2019 GitHub, Inc.
Terms
Privacy
Security
Status
Help
Contact GitHub
Pricing
API
Training
Blog
About
library(microbiomeSeq)
library(devtools)
install_github("umerijaz/microbiomeSeq")
library(microbiomeSeq)
install.packages("vegan")
library(devtools)
install_github("umerijaz/microbiomeSeq")
library(microbiomeSeq)
library(devtools)
install_github("umerijaz/microbiomeSeq")
demo()
q()
if(!requireNamespace("BiocManager")){
install.packages("BiocManager")
}
BiocManager::install("phyloseq")
install_github("umerijaz/microbiomeSeq")  # Install the package
library(githubinstall)
library(devtools)
install.packages("WGCNA")
install.packages("fso")
install.packages("randomForest")
library(phyloseq)
library(vegan)
library(DESeq2)
library(ggplot2)
library(randomForest)
library(gridExtra)
library(data.table)
library(fso)
library(WGCNA)
library(igraph)
library(devtools)  # Load the devtools package
install_github("umerijaz/microbiomeSeq")  # Install the package
library(microbiomeSeq)  #load the package
install.packages("C:/Users/kiumars/Downloads/microbiomeSeq-master.zip", repos = NULL, type = "win.binary")
install.packages(microbiomeseq)
githubinstall::gh_install_packages(microbiomeseq)
library(devtools)
detach("package:devtools", unload = TRUE)
library(devtools)
install_github("umerijaz/microbiomeSeq")
detach(data.table)
install.packages("microbiomeseq")
install.packages("dplyr")
install.packages("devtools")
install_github("umerijaz/microbiomeSeq")
install.packages("githubinstall")
install_github("umerijaz/microbiomeSeq")
library(githubinstall)
install_github("umerijaz/microbiomeSeq")
(!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("AnnotationDbi", "DESeq2", "GO.db", "impute", "phyloseq", "preprocessCore"))
install.packages("BiocManager")
(!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("AnnotationDbi", "DESeq2", "GO.db", "impute", "phyloseq", "preprocessCore"))
install_github("umerijaz/microbiomeSeq")
library(githubinstall)
install_github("umerijaz/microbiomeSeq")
githubinstall::githubinstall("umerijaz/microbiomeSeq")
install.packages("adespatial")
install.packages("C:/Users/kiumars/Downloads/ranacapa-master.zip", repos = NULL, type = "win.binary")
install.packages("C:/Users/kiumars/Downloads/ranacapa-master.zip", repos = NULL, type = "win.binary")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
library(devtools)
library(devtools)
devtools::install_github("gauravsk/ranacapa")
install.packages("pulsar")
install.packages("VGAM")
library(devtools)
install_github("zdk123/SpiecEasi")
library(SpiecEasi)
install.packages("huge")
library(devtools)
install_github("zdk123/SpiecEasi")
library(SpiecEasi)
force = true
force = TRUE
library(devtools)
install_github("zdk123/SpiecEasi")
library(SpiecEasi)
force = TRUE
plot(x=log(l$area), y=log(l$tnlc), main="Logged Linear Regression Model for Leaf Size & Leaf Number", cex.main=1.65,
abline(mod), cex=log(l$dbh/500+0.5),
xlab = "Leaf Area", ylab = "Leaf Number", cex.lab=1.5,
pch=16, col=round(l$cii), las=1)
##the histogram of leaf area distribution and the log
hist((l$area), main="Distribution of Leaf Area", cex.main=2, xlab=expression(paste("Leaf Area(", cm^2,")")),
ylab="Number of Saplings", cex.lab=1.5, border="dark blue", col="chartreuse3",
breaks=20, ylim=c(0,200), xlim=c(0,800), las=1, fontsize=c(30))
##the histogram of leaf area distribution and the log
hist((l$area), main="Distribution of Leaf Area", cex.main=2, xlab=expression(paste("Leaf Area(", cm^2,")")),
ylab="Number of Saplings", cex.lab=1.5, border="dark blue", col="chartreuse3",
breaks=20, ylim=c(0,200), xlim=c(0,800), las=1, fontsize=c(30))
hist((l$area), main="Distribution of Leaf Area", cex.main=2, xlab=expression(paste("Leaf Area(", cm^2,")")),
ylab="Number of Saplings", cex.lab=1.5, border="dark blue", col="chartreuse3",
breaks=20, ylim=c(0,200), xlim=c(0,800), las=1, fontsize=c(30))
read.csv("Leaf Area and Shape From Trip5-10.csv")
setwd("leaf area and shape")
read.csv("Leaf Area and Shape From Trip5-10.csv")
read.csv("Leaf Area and Shape From Trip5-10.csv")
c = read.csv("Leaf Area and Shape From Trip5-10.csv", stringsAsFactors = FALSE)
head(c)
str(c)
c  = c[215:4540,]
d = strsplit(c$file.name, "_")
e = lapply(d, function(x) x[1])
f = unlist(e)
as.numeric(f)
f[which(is.na(as.numeric(f)))]
f[f=="230182POUFUL"]= 230182
f[f=="230378LACSP1"]= 230378
f = as.numeric(f)
c $plant.ID = f
head (c)
k = aggregate(Area.pred..cm.2.~plant.ID,c,mean)
read.csv("architect.csv")
architect = read.csv("architect.csv")
architect= subset(architect, select = c("plantID", "dbh", "tnlc", "cii"))
names(k)
names(k)[1] = "plantID"
names(k)[2] = "area"
l= merge(architect, k, by = "plantID")
l= merge(architect, k, by = "plantID")
l= subset(l, !is.na(dbh) & !is.na(tnlc) & !is.na(cii))
##use this function to add two graphs on top of each other
par(mfrow=c(1,1))
par(bg="transparent")
##the histogram of leaf area distribution and the log
hist((l$area), main="Distribution of Leaf Area", cex.main=2, xlab=expression(paste("Leaf Area(", cm^2,")")),
ylab="Number of Saplings", cex.lab=1.5, border="dark blue", col="chartreuse3",
breaks=20, ylim=c(0,200), xlim=c(0,800), las=1, fontsize=c(30))
hist(log(l$area), main="", ylab="Number of Saplings", xlab="Log Leaf Area", cex.lab=1.5,
border="dark blue", col="chartreuse3", breaks=20, las=1, ylim=c(0,60), xlim=c(1,7), fontsize=c(30))
hist((l$tnlc), main="Distribution of Leaf Number", cex.main=2, xlab="Total leaf number per individual",
ylab="Number of Saplings", cex.lab=1.5, border="dark blue", col="chartreuse3", nclass=20, ylim=c(0,250), xlim=c(0,2500), las=1, fontsize=c(30))
plot(area~tnlc, l, log="xy", main= "Leaf Area/Number Before Log Transformation", ylab= "Leaf Area", xlab= "Total Number of Leaf Count")
## to make histogram for leaf size histogram
hist(log(l$area))
lm(log(l$tnlc)~log(l$area))
plot(x=log(l$area), y=log(l$tnlc), main="Logged Linear Regression Model for Leaf Size & Leaf Number", cex.main=1.65,
abline(mod), cex=log(l$dbh/500+0.5),
xlab = "Leaf Area", ylab = "Leaf Number", cex.lab=1.5,
pch=16, col=round(l$cii), las=1)
plot(x=log(l$area), y=log(l$tnlc), main="Logged Linear Regression Model for Leaf Size & Leaf Number", cex.main=1.65,
abline (mod), cex=log(l$dbh/500+0.5),
xlab = "Leaf Area", ylab = "Leaf Number", cex.lab=1.5,
pch=16, col=round(l$cii), las=1)
plot(x=log(l$area), y=log(l$tnlc), main="Logged Linear Regression Model for Leaf Size & Leaf Number", cex.main=1.65,
abline (mod), cex=log(l$dbh/500+0.5),
xlab = "Leaf Area", ylab = "Leaf Number", cex.lab=1.5,
pch=16, col=round(l$cii), las=1)
plot(x=log(l$area), y=log(l$tnlc), main="Logged Linear Regression Model for Leaf Size & Leaf Number", cex.main=1.65,
abline (mod), cex=log(l$dbh/500+0.5),
xlab = "Leaf Area", ylab = "Leaf Number", cex.lab=1.5,
pch=16, col=round(l$cii), las=1)
plot(x=log(l$area), y=log(l$tnlc), main="Logged Linear Regression Model for Leaf Size & Leaf Number", cex.main=1.65,
abline(mod), cex=log(l$dbh/500+0.5),
xlab = "Leaf Area", ylab = "Leaf Number", cex.lab=1.5,
pch=16, col=round(l$cii), las=1)
plot(x=log(l$area), y=log(l$tnlc), main="Logged Linear Regression Model for Leaf Size & Leaf Number", cex.main=1.65, cex=log(l$dbh/500+0.5),
xlab = "Leaf Area", ylab = "Leaf Number", cex.lab=1.5,
pch=16, col=round(l$cii), las=1)
=======
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
curve(exp(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
plot(y=log(l$tnlc),x=log(l$dbh),xlab="Log(DBH)",ylab="Log(number of leaves)")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
abline(a=exp(nd.mod$coef[1]),b=nd.mod$coef[2],col=2,lwd=2)
curve(exp(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
abline(a=exp(nd.mod$coef[1]),b=nd.mod$coef[2],col=2,lwd=2)
curve(exp(nd.mod$coef[1]+nd.mod$coef[2]*x,add=T,col=2,lwd=2)
plot(y=log(l$tnlc),x=log(l$dbh),xlab="Log(DBH)",ylab="Log(number of leaves)")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
abline(a=exp(nd.mod$coef[1]),b=nd.mod$coef[2],col=2,lwd=2)
curve(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
curve(exp(nd.mod$coef[1]+nd.mod$coef[2]*x),add=T,col=2,lwd=2)
plot(y=log(l$tnlc),x=log(l$dbh),xlab="Log(DBH)",ylab="Log(number of leaves)")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
abline(a=exp(nd.mod$coef[1]),b=nd.mod$coef[2],col=2,lwd=2)
curve(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
nd.mod$coef[1])
nd.mod$coef[1]
abline(nd.mod,col=2,lwd=2)
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
abline(a=exp(nd.mod$coef[1]),b=nd.mod$coef[2],col=2,lwd=2)
curve(exp(nd.mod$coef[1]+nd.mod$coef[2]*x),add=T,col=2,lwd=2)
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
curve(exp(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
plot(nd.mod)
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
curve(exp(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
nd.mod$residuals
hist(nd.mod$residuals)
hist(log(nd.mod$residuals))
head()
head(l)
lm(nd.mod$residuals~log(l$area))
nda.mod = lm(nd.mod$residuals~log(l$area)); summary(nd.mod)
nda.mod = lm(nd.mod$residuals~log(l$area)); summary(nda.mod)
head(l)
traits = read.csv("traits.csv") # load raw trait data frame
traits
head(traits)
head(l)
g = merge(x=traits[,c("plantID", "spcod")],y=l,by= "plantID")
head(g)
length(unique(g$spcod)) # number of species sampled
l$tnlc*l$area
hist(l$tnlc*l$area)
hist(log(l$tnlc*l$area))
plot(x=l$dbh,y=log(l$tnlc*l$area))
plot(x=log(l$dbh),y=log(l$tnlc*l$area))
ad.mod = lm(log(l$tnlc*l$area)~log(l$dbh))
ad.mod = lm(log(l$tnlc*l$area)~log(l$dbh)); summary(ad.mod)
head(traits)
head(g)
g = merge(x=traits[,c("plantID", "spcod","muf")],y=l,by= "plantID")
head(g)
length(unique(g$spcod)) # number of species sampled
g$muf
head(traits)
plot(x=log(l$dbh),y=log(l$tnlc*l$area))
c = read.csv("Leaf Area and Shape From Trip5-10.csv", stringsAsFactors = FALSE) # load raw leaf area data
head(c); str(c)
c  = c[215:4540,] # remove empty lines
d = strsplit(c$file.name, "_") # split file name in order to extract plant ID
e = lapply(d, function(x) x[1]) # extract plant ID
f = unlist(e) # coerce the list into a vector
# Some small fixs..
f[f=="230182POUFUL"]= 230182
f[f=="230378LACSP1"]= 230378
f= as.numeric(f) # coerce a character vector into a numeric one (plants without a valid ID will be assigned NAs)
c $plant.ID = f # fill plant ID column in the original data frame
k = aggregate(Area.pred..cm.2.~plant.ID,c,mean) # claculate mean leaf size per plant
architect = read.csv("architect.csv") # load raw architecture data
architect= subset(architect, select = c("plantID", "dbh", "tnlc", "cii")) # simplify architecture data frame
# Change column names
names(k)[1] = "plantID"
names(k)[2] = "area"
l= merge(architect, k, by = "plantID") # combine architecture and leaf size data frames
l= subset(l, !is.na(dbh) & !is.na(tnlc) & !is.na(cii)) # remove NAs
l$dbh = l$dbh/1000 # rescale DBH to cm
head(l)
nd.mod = lm(log(tnlc)~log(dbh),l); summary(nd.mod)
nda.mod = lm(nd.mod$residuals~log(l$area)); summary(nda.mod)
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
curve(exp(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
traits = read.csv("traits.csv") # load raw trait data frame
g = merge(x=traits[,c("plantID", "spcod","muf")],y=l,by= "plantID")
head(g)
length(unique(g$spcod)) # number of species sampled
ad.mod = lm(log(l$tnlc*l$area)~log(l$dbh)); summary(ad.mod)
plot(x=log(l$dbh),y=log(l$tnlc*l$area))
head(g)
subset(g,plantID%in%c(230182,230303,230046,230441,230464,240266,220078,220212,15364,100790))
subset(g,plantID%in%c(230182,230303,230046,230441,230464,240226,220078,220212,15364,100790))
c = read.csv("Leaf Area and Shape From Trip5-10.csv", stringsAsFactors = FALSE) # load raw leaf area data
head(c); str(c)
c  = c[215:4540,] # remove empty lines
d = strsplit(c$file.name, "_") # split file name in order to extract plant ID
e = lapply(d, function(x) x[1]) # extract plant ID
f = unlist(e) # coerce the list into a vector
# Some small fixs..
f[f=="230182POUFUL"]= 230182
f[f=="230378LACSP1"]= 230378
f= as.numeric(f) # coerce a character vector into a numeric one (plants without a valid ID will be assigned NAs)
c $plant.ID = f # fill plant ID column in the original data frame
k = aggregate(Area.pred..cm.2.~plant.ID,c,mean) # claculate mean leaf size per plant
architect = read.csv("architect.csv") # load raw architecture data
architect= subset(architect, select = c("plantID", "dbh", "tnlc", "cii")) # simplify architecture data frame
# Change column names
names(k)[1] = "plantID"
names(k)[2] = "area"
l= merge(architect, k, by = "plantID") # combine architecture and leaf size data frames
l= subset(l, !is.na(dbh) & !is.na(tnlc) & !is.na(cii)) # remove NAs
l$dbh = l$dbh/1000 # rescale DBH to cm
head(l)
nd.mod = lm(log(tnlc)~log(dbh),l); summary(nd.mod)
nda.mod = lm(nd.mod$residuals~log(l$area)); summary(nda.mod)
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
curve(exp(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
traits = read.csv("traits.csv") # load raw trait data frame
g = merge(x=traits[,c("plantID", "spcod","muf")],y=l,by= "plantID")
head(g)
length(unique(g$spcod)) # number of species sampled
ad.mod = lm(log(l$tnlc*l$area)~log(l$dbh)); summary(ad.mod)
plot(x=log(l$dbh),y=log(l$tnlc*l$area))
head(g)
subset(g,plantID%in%c(230182,230303,230046,230441,230464,240266,220078,220212,15364,100790))
nrow(l)
exp(c(3,6
))
sqrt(exp(c(3,6)))
range(l$area)
median(l$area)
log(72)
sqrt(72)
l$tnlc*l$area
l$tnlc*l$area
mean(l$tnlc*l$area)
median(l$tnlc*l$area)
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
curve(exp(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
range(l$dbh)
mod = lm(log(tnlc)~log(area),l); summary(mod)
mod
curve(exp(mod$coef[1])*x^mod$coef[2])
curve(exp(mod$coef[1])*x^mod$coef[2],from=0,to=max(l$area))
curve(exp(mod$coef[1])*x^mod$coef[2],from=0,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number")
curve(median(l$tnlc*l$area)/x)
curve(exp(mod$coef[1])*x^mod$coef[2],from=0,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number")
curve(median(l$tnlc*l$area)/x,add=T,col=2)
curve(exp(mod$coef[1])*x^mod$coef[2],from=0,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number")
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
curve(exp(mod$coef[1])*x^mod$coef[2],from=0,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
mod
summary(mod)
curve(mean(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
curve(mean(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
exp(3)
?lm
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
mod$coef[1]
mod$coef[2]
curve(mod$coef[1]+x*mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
exp(0)
mod$coef[1]
max(l$area)
curve(mod$coef[1]+x*mod$coef[2],from=0.1,to=max(log(l$area)),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
curve(mod$coef[1]+x*mod$coef[2],from=min(log(l$area)),to=max(log(l$area)),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
curve(log(median(l$tnlc*l$area))/log(x),add=T,col=2,from=0.1,to=max(l$area))
curve(log(median(l$tnlc*l$area))-log(x),add=T,col=2,from=0.1,to=max(l$area))
curve(mod$coef[1]+x*mod$coef[2],from=min(log(l$area)),to=max(log(l$area)),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
curve(log(median(l$tnlc*l$area))-log(x),add=T,col=2,from=0.1,to=max(l$area))
curve(log(median(l$tnlc*l$area))-log(x),add=T,col=2,from=0.1,to=max(l$area))
curve(log(median(l$tnlc*l$area))-log(x),add=T,col=2,to=max(l$area))
curve(log(median(l$tnlc*l$area))/log(x),add=T,col=2,to=max(l$area))
curve(mod$coef[1]+x*mod$coef[2],from=min(log(l$area)),to=max(log(l$area)),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
curve(log(median(l$tnlc*l$area))/log(x),add=T,col=2)
curve(mod$coef[1]+x*mod$coef[2],from=min(log(l$area)),to=max(log(l$area)),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
curve(log(median(l$tnlc*l$area))/log(x),add=T,col=2)
curve(log(median(l$tnlc*l$area))-log(x),add=T,col=2)
curve(mod$coef[1]+x*mod$coef[2],from=min(log(l$area)),to=max(log(l$area)),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
curve(log(median(l$tnlc*l$area))-log(x),add=T,col=2)
log(median(l$tnlc*l$area))
log(2)
curve(log(median(l$tnlc*l$area))-log(x),add=T,col=2)
curve(mod$coef[1]+x*mod$coef[2],from=min(log(l$area)),to=max(log(l$area)),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="",ylim=c(0,10))
curve(log(median(l$tnlc*l$area))-log(x),add=T,col=2)
log(0)
log(0.0000001)
log(4)
mod
summary(mod)
nd.mod = lm(log(tnlc)~log(dbh),l); summary(nd.mod)
nda.mod = lm(nd.mod$residuals~log(l$area)); summary(nda.mod)
m.mod = lm(log(tnlc)~log(dbh)*cii*log(area),l)
m.mod
summary(m.mod)
nda.mod = lm(nd.mod$residuals~log(l$area)); summary(nda.mod)
m.mod = lm(log(tnlc)~log(dbh)+cii+log(area),l); summary(m.mod)
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
legend("topleft",text.col=2,c(expression(paste(R^2," = 0.09")),"p < 0.001"),bty="n")
curve(exp(nd.mod$coef[1])*x^nd.mod$coef[2],add=T,col=2,lwd=2)
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
curve(mod$coef[1]+x*mod$coef[2],from=min(log(l$area)),to=max(log(l$area)),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="",ylim=c(0,10))
curve(log(median(l$tnlc*l$area))-log(x),add=T,col=2)
plot(mod)
plot(log(tnlc)~log(area),l)
lm(log(tnlc*area)~log(dbh),l)
tla.mod = lm(log(tnlc*area)~log(dbh),l)
tla.mod
tla.mod = lm(log(tnlc*area)~log(dbh),l); summary(tla.mod)
plot(log(tnlc*area)~log(dbh),l)
plot(log(tnlc*area)~log(dbh),l)
plot(tnlc*area~dbh,l)
plot(log(tnlc*area)~log(dbh),l)
summary(tla.mod)
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
curve(mod$coef[1]+x*mod$coef[2],from=min(log(l$area)),to=max(log(l$area)),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="",ylim=c(0,10))
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="")
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
curve(median(l$tnlc*l$area)/x,add=T,col=2,from=0.1,to=max(l$area))
range(log(tnlc*area))
range(log(l$tnlc*l$area))
range((l$tnlc*l$area))
summary(m.mod)
m.mod = lm(log(tnlc*area)~log(dbh)+cii,l); summary(m.mod)
m.mod = lm(log(tnlc*area)~log(dbh)+cii,l); summary(m.mod)
plot(y=l$tnlc,x=l$dbh,log="xy",xlab="Sapling DBH (cm)",ylab="Total number of leaves")
curve(exp(mod$coef[1])*x^mod$coef[2],from=0.1,to=max(l$area),xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",log="xy")
plot(log(tnlc)~log(area),l)
range(log(l$tnlc*l$area))
range((l$tnlc*l$area))
curve(200/x)
plot(log(tnlc)~log(area),l)
curve(200/x,add=T,col=2)
plot((tnlc)~(area),l)
curve(200/x,add=T,col=2)
plot((tnlc)~(area),l,log="xy")
curve(200/x,add=T,col=2)
curve(73000/x,add=T,col=2)
curve(74000/x,add=T,col=2)
curve(75000/x,add=T,col=2)
curve(80000/x,add=T,col=2)
plot((tnlc)~(area),l,log="xy")
curve(200/x,add=T,col=2)
curve(80000/x,add=T,col=2)
curve(log(80000)-log(x),add=T,col=3)
plot(log(tnlc)~log(area),l)
curve(log(80000)-log(x),add=T,col=2)
plot((tnlc)~(area),l,log="xy")
curve(200/x,add=T,col=2)
curve(80000/x,add=T,col=2)
curve(200/x,add=T,col=2,from=1,to=600)
curve(200/x,add=T,col=2,from=1,to=1000)
curve(80000/x,add=T,col=2,from=1,to=1000)
plot((tnlc)~(area),l,log="xy")
curve(200/x,add=T,col=2,from=1,to=1000,lty=3)
curve(80000/x,add=T,col=2,from=1,to=1000,lty=3)
plot((tnlc)~(area),l,log="xy")
curve(200/x,add=T,col=2,from=1,to=1000,lty=2)
curve(80000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(200/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
plot((tnlc)~(area),l,log="xy")
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
exp(mod$coef[1])
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
range(l$area)
range(l$tlnc)
l$tlnc
range(l$tnlc)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")))
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number")
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.5))
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
mod$coef[1]
mod$coef
round(mod$coef[2],2)
legend("topright",round(mod$coef[2],2),bty="n")
legend("topright",legend=round(mod$coef[2],2),bty="n")
legend("topright",legend=round(mod$coef[2],2),bty="n",text.col=2,text.font=2)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=round(mod$coef[2],2),bty="n",text.col=2,text.font=2)
paste0("slope = ",round(mod$coef[2],2))
summary(mod)
paste0("slope = ",round(mod$coef[2],2),"***")
summary(mod)
summary(mod)$coef
summary(mod)$coef[2,2]
round(summary(mod)$coef[2,2],2)
paste0("SE = ",round(summary(mod)$coef[2,2],2))
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2,text.font=2)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2,text.font=2)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
locator(4)
text(c(100,1000,10000,100000),x=c(26,255,5,50),y=c(5,5,2321,2650))
?text
text(c(100,1000,10000,100000),x=c(26,255,5,50),y=c(5,5,2321,2650),col=2,cex=.7,srt=-1)
text(c(100,1000,10000,100000),x=c(26,255,5,50),y=c(5,5,2321,2650),col=2,cex=.7,srt=-45)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c(100,1000,10000,format(100000,sci=F)),x=c(26,255,5,50),y=c(5,5,2321,2650),col=2,cex=.7,srt=-45)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("100","1000","10000","100000"),x=c(26,255,5,50),y=c(5,5,2321,2650),col=2,cex=.7,srt=-45)
expression(paste(c("100","1000","10000","100000"),cm^2))
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(expression(paste(c("100","1000","10000","100000"),cm^2)),x=c(26,255,5,50),y=c(5,5,2321,2650),col=2,cex=.7,srt=-45)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("100","1000","10000","100000"),x=c(26,255,5,50),y=c(5,5,2321,2650),col=2,cex=.7,srt=-45)
text(c("100","1000","10000","100000"),x=c(26,255,5,49),y=c(5,5,2321,2650),col=2,cex=.7,srt=-45)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,5,2321,2650),col=2,cex=.7,srt=-45)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,5,2321,2650),col=2,cex=.7,srt=-46)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,5,2321,2650),col=2,cex=.7,srt=-5)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,5,2321,2650),col=2,cex=.7,srt=-3)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,5,2321,2650),col=2,cex=.7,srt=-3)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,5,2321,2650),col=2,cex=.7,srt=-30)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,5,2321,2650),col=2,cex=.7,srt=-60)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,5,2321,2650),col=2,cex=.7,srt=-50)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,5,2321,2650),col=2,cex=.7,srt=-50)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,4,2321,2650),col=2,cex=.7,srt=-50)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(5,4.5,2321,2650),col=2,cex=.7,srt=-50)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(4.5,4.5,2321,2650),col=2,cex=.7,srt=-50)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(4.5,4.5,2321,2650),col=2,cex=.7,srt=-50)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(4.5,4.5,2321,2650),col=2,cex=.7,srt=-45)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(4.5,4.5,2321,2650),col=2,cex=.7,srt=-45)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("100","1000","10000","100000"),x=c(26,255,5,45),y=c(4.5,4.5,2321,2650),col=2,cex=.7,srt=-50)
sqrt(10000)
100/10000
1000/10000
expression(paste("Total leaf area = 10",m^2))
text(expression(paste("Total leaf area = 10",m^2)),x=45,y=2650,col=2,cex=.7,srt=-50)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("0.01","0.1","1.0"),x=c(26,255,5),y=c(4.5,4.5,2321),col=2,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2650,col=2,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2600,col=2,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2500,col=2,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2000,col=2,cex=.7,srt=-50)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("0.01","0.1","1.0"),x=c(26,255,5),y=c(4.5,4.5,2321),col=2,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2000,col=2,cex=.7,srt=-50)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("0.01","0.1","1.0"),x=c(26,255,5),y=c(4.5,4.5,2321),col=1,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2000,col=1,cex=.7,srt=-50)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=2,from=1,to=1000,lty=1)
curve(1000/x,add=T,col=2,from=1,to=1000,lty=1)
curve(10000/x,add=T,col=2,from=1,to=1000,lty=1)
curve(100000/x,add=T,col=2,from=1,to=1000,lty=1)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("0.01","0.1","1.0"),x=c(26,255,5),y=c(4.5,4.5,2321),col=1,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2000,col=1,cex=.7,srt=-50)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=1,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=1,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=1,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=1,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(c("0.01","0.1","1.0"),x=c(26,255,5),y=c(4.5,4.5,2321),col=1,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2000,col=1,cex=.7,srt=-50)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=1,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=1,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=1,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=1,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(expression(paste("0.01 ",m^2),x=26,y=4.5,col=1,cex=.7,srt=-50)
text(expression(paste("0.01 ",m^2)),x=26,y=4.5,col=1,cex=.7,srt=-50)
text(expression(paste("0.1 ",m^2)),x=255,y=4.5,col=1,cex=.7,srt=-50)
text(expression(paste("1.0 ",m^2)),x=5,y=2321,col=1,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2000,col=1,cex=.7,srt=-50)
plot((tnlc)~(area),l,log="xy",xlab=expression(paste("Leaf area (",cm^2,")")),ylab="Leaf number",pch=16,col=grey(.5,.7))
curve(100/x,add=T,col=1,from=1,to=1000,lty=2)
curve(1000/x,add=T,col=1,from=1,to=1000,lty=2)
curve(10000/x,add=T,col=1,from=1,to=1000,lty=2)
curve(100000/x,add=T,col=1,from=1,to=1000,lty=2)
curve(exp(mod$coef[1])*x^mod$coef[2],add=T,col=2,lwd=2,from=1,to=1000)
legend("topright",legend=c(paste0("slope = ",round(mod$coef[2],2),"***"),paste0("SE = ",round(summary(mod)$coef[2,2],2))),bty="n",text.col=2)
text(expression(paste("0.01 ",m^2)),x=26,y=4.5,col=1,cex=.7,srt=-50)
text(expression(paste("0.1 ",m^2)),x=255,y=4.5,col=1,cex=.7,srt=-50)
text(expression(paste("1.0 ",m^2)),x=5,y=2321,col=1,cex=.7,srt=-50)
text(expression(paste("Total leaf area = 10 ",m^2)),x=60,y=2000,col=1,cex=.7,srt=-50)
>>>>>>> 0ae59f90ce7e77635940a659826fff69184f4d9c
